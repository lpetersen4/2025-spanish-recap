<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 Spanish Recap</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    :root {
      --bg: #0a0a0f;
      --surface: #13131a;
      --surface2: #1c1c26;
      --border: rgba(255,255,255,0.07);
      --text: #ededf5;
      --muted: #7070888;
      --teal: #2dd4bf;
      --teal-glow: rgba(45,212,191,0.18);
      --orange: #fb923c;
      --orange-glow: rgba(251,146,60,0.18);
      --purple: #c084fc;
      --purple-glow: rgba(192,132,252,0.18);
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    /* â”€â”€â”€ Hero â”€â”€â”€ */
    .hero {
      min-height: 420px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 80px 24px 70px;
      background:
        radial-gradient(ellipse 80% 60% at 50% -10%, rgba(251,146,60,0.15) 0%, transparent 60%),
        radial-gradient(ellipse 60% 40% at 80% 100%, rgba(251,100,30,0.08) 0%, transparent 50%),
        var(--bg);
      position: relative;
    }
    .hero-emoji { font-size: 52px; margin-bottom: 20px; line-height: 1; }
    .hero h1 {
      font-size: clamp(44px, 9vw, 88px);
      font-weight: 900;
      letter-spacing: -2px;
      line-height: 1.05;
      background: linear-gradient(140deg, #fff3e0 10%, var(--orange) 45%, #f43f5e 90%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 16px;
    }
    .hero-sub {
      font-size: 17px;
      color: #9090a8;
      font-weight: 400;
      letter-spacing: 0.3px;
    }

    /* â”€â”€â”€ Layout â”€â”€â”€ */
    .section {
      max-width: 1160px;
      margin: 0 auto;
      padding: 56px 24px;
    }
    .section-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 2.5px;
      text-transform: uppercase;
      color: #606078;
      margin-bottom: 22px;
    }

    /* â”€â”€â”€ Stat Cards â”€â”€â”€ */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
      gap: 14px;
    }
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 22px 22px 20px;
      position: relative;
      overflow: hidden;
      transition: transform 0.15s;
    }
    .card:hover { transform: translateY(-2px); }
    .card::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 18px;
      opacity: 0;
      transition: opacity 0.15s;
    }
    .card-accent {
      width: 36px; height: 4px;
      border-radius: 999px;
      margin-bottom: 16px;
    }
    .c-teal .card-accent { background: var(--teal); box-shadow: 0 0 12px var(--teal-glow); }
    .c-orange .card-accent { background: var(--orange); box-shadow: 0 0 12px var(--orange-glow); }
    .c-purple .card-accent { background: var(--purple); box-shadow: 0 0 12px var(--purple-glow); }
    .c-white .card-accent { background: linear-gradient(90deg, var(--orange), #f43f5e); }

    .card-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: #606078;
      margin-bottom: 8px;
    }
    .card-value {
      font-size: 38px;
      font-weight: 900;
      letter-spacing: -1px;
      line-height: 1;
      margin-bottom: 5px;
    }
    .c-teal .card-value { color: var(--teal); }
    .c-orange .card-value { color: var(--orange); }
    .c-purple .card-value { color: var(--purple); }
    .c-white .card-value { color: var(--text); }
    .card-sub { font-size: 12px; color: #60607a; line-height: 1.4; }

    /* â”€â”€â”€ Chart Panels â”€â”€â”€ */
    .panel {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 28px 28px 24px;
      margin-bottom: 20px;
    }
    .panel h3 { font-size: 15px; font-weight: 700; margin-bottom: 4px; }
    .panel-sub { font-size: 12px; color: #60607a; margin-bottom: 22px; }

    .legend {
      display: flex; gap: 18px; flex-wrap: wrap;
      margin-bottom: 18px;
    }
    .legend-item {
      display: flex; align-items: center; gap: 7px;
      font-size: 12px; font-weight: 600; color: #9090a8;
    }
    .legend-dot { width: 9px; height: 9px; border-radius: 50%; }

    .chart-box { position: relative; width: 100%; }
    .chart-scroll { overflow-x: auto; overflow-y: hidden; -webkit-overflow-scrolling: touch; }
    .chart-scroll canvas { display: block; }

    /* â”€â”€â”€ Milestones â”€â”€â”€ */
    .milestones {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 14px;
    }
    .milestone {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 22px;
      display: flex;
      align-items: center;
      gap: 18px;
    }
    .ms-icon { font-size: 30px; flex-shrink: 0; }
    .ms-label {
      font-size: 11px; font-weight: 700;
      text-transform: uppercase; letter-spacing: 1.5px;
      color: #606078; margin-bottom: 4px;
    }
    .ms-value { font-size: 20px; font-weight: 800; letter-spacing: -0.5px; }
    .ms-detail { font-size: 12px; color: #60607a; margin-top: 2px; }

    /* â”€â”€â”€ Monthly breakdown table â”€â”€â”€ */
    .month-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
      gap: 12px;
    }
    .month-cell {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px 16px;
    }
    .mc-name { font-size: 13px; font-weight: 700; margin-bottom: 8px; }
    .mc-row { display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 3px; }
    .mc-row span:first-child { color: #606078; }
    .mc-row span:last-child { font-weight: 600; }

    /* â”€â”€â”€ Footer â”€â”€â”€ */
    footer {
      text-align: center;
      padding: 36px 24px;
      font-size: 12px;
      color: #404058;
      border-top: 1px solid var(--border);
    }

    @media (max-width: 600px) {
      .hero { padding: 60px 16px 50px; }
      .section { padding: 40px 16px; }
      .panel { padding: 20px 16px 18px; }
    }

    /* â”€â”€â”€ PDF Button â”€â”€â”€ */
    .pdf-btn {
      position: fixed;
      bottom: 28px;
      right: 28px;
      z-index: 1000;
      background: var(--orange);
      color: #0a0a0f;
      border: none;
      border-radius: 50px;
      padding: 12px 22px;
      font-family: inherit;
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.3px;
      cursor: pointer;
      box-shadow: 0 4px 24px rgba(251,146,60,0.4);
      transition: transform 0.15s, box-shadow 0.15s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .pdf-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 28px rgba(251,146,60,0.55); }
    .pdf-btn svg { width: 16px; height: 16px; fill: currentColor; flex-shrink: 0; }

    /* â”€â”€â”€ Print / PDF styles â”€â”€â”€ */
    @media print {
      @page {
        size: A4;
        margin: 15mm 12mm;
      }

      .pdf-btn { display: none !important; }

      body {
        background: #fff !important;
        color: #111 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }

      :root {
        --bg: #fff;
        --surface: #f5f5f7;
        --surface2: #ebebef;
        --border: rgba(0,0,0,0.1);
        --text: #111;
        --teal: #0d9488;
        --teal-glow: rgba(13,148,136,0.15);
        --orange: #ea580c;
        --orange-glow: rgba(234,88,12,0.15);
        --purple: #9333ea;
        --purple-glow: rgba(147,51,234,0.15);
      }

      .hero {
        background: linear-gradient(135deg, #fff3e0 0%, #ffe0cc 100%) !important;
        min-height: 220px !important;
        padding: 40px 24px !important;
        break-inside: avoid;
      }

      .hero h1 {
        background: linear-gradient(140deg, #c2410c 10%, #ea580c 90%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
        font-size: 52px !important;
      }

      .hero-sub { color: #555 !important; }

      .card {
        background: #f5f5f7 !important;
        border-color: rgba(0,0,0,0.12) !important;
        break-inside: avoid;
      }
      .card-sub { color: #555 !important; }

      .panel {
        background: #f5f5f7 !important;
        border-color: rgba(0,0,0,0.12) !important;
        break-inside: avoid;
        page-break-inside: avoid;
      }
      .panel-sub, .section-label { color: #666 !important; }

      .milestone {
        background: #f5f5f7 !important;
        border-color: rgba(0,0,0,0.12) !important;
        break-inside: avoid;
      }
      .ms-detail { color: #555 !important; }

      .month-cell {
        background: #ebebef !important;
        border-color: rgba(0,0,0,0.1) !important;
      }
      .mc-row span:first-child { color: #555 !important; }

      footer {
        color: #888 !important;
        border-top-color: rgba(0,0,0,0.1) !important;
      }

      /* Prevent scrollable chart from clipping */
      .chart-scroll {
        overflow: visible !important;
        height: auto !important;
      }
      .chart-scroll canvas {
        max-width: 100% !important;
        width: 100% !important;
        height: 180px !important;
      }

      .chart-box { break-inside: avoid; }

      .cards { grid-template-columns: repeat(3, 1fr) !important; }
      .milestones { grid-template-columns: repeat(2, 1fr) !important; }
      .month-grid { grid-template-columns: repeat(4, 1fr) !important; }

      .section { padding: 28px 0 !important; }
    }
  </style>
</head>
<body>

<div class="hero">
  <div class="hero-emoji">ğŸ‡¦ğŸ‡·</div>
  <h1>2025 Spanish<br>Recap</h1>
  <p class="hero-sub">A year of listening, reading &amp; speaking in numbers</p>
</div>

<div class="section">
  <div class="section-label">Year in Numbers</div>
  <div class="cards" id="stat-cards"></div>
</div>

<div class="section" style="padding-top:0">
  <div class="section-label">Monthly Overview</div>
  <div class="panel">
    <h3>Minutes by Month</h3>
    <p class="panel-sub">Total practice per skill each month</p>
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--orange)"></div>Listening</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--teal)"></div>Reading</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--purple)"></div>Speaking</div>
    </div>
    <div class="chart-box" style="height:300px">
      <canvas id="monthlyChart"></canvas>
    </div>
  </div>
</div>

<div class="section" style="padding-top:0">
  <div class="section-label">Daily Listening</div>
  <div class="panel">
    <h3>Every Day of the Year</h3>
    <p class="panel-sub">Listening minutes per day â€” scroll to explore all 366 days</p>
    <div class="chart-scroll" style="height:240px">
      <canvas id="dailyChart" height="240"></canvas>
    </div>
  </div>
</div>

<div class="section" style="padding-top:0">
  <div class="section-label">Cumulative Progress</div>
  <div class="panel">
    <h3>Total Listening Hours Over the Year</h3>
    <p class="panel-sub">Running total of hours accumulated day by day</p>
    <div class="chart-box" style="height:260px">
      <canvas id="cumulativeChart"></canvas>
    </div>
  </div>
</div>

<div class="section" style="padding-top:0">
  <div class="section-label">Highlights</div>
  <div class="milestones" id="milestones"></div>
</div>

<div class="section" style="padding-top:0">
  <div class="section-label">Month by Month</div>
  <div class="month-grid" id="month-grid"></div>
</div>

<footer>
  2025 Spanish Tracking Â· Built with Chart.js
</footer>

<button class="pdf-btn" onclick="window.print()">
  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 16l-5-5 1.41-1.41L11 13.17V4h2v9.17l2.59-2.58L17 11l-5 5zm-6 4v-2h12v2H6z"/>
  </svg>
  Save as PDF
</button>

<script>
const CSV = `Year,Month,Day,Listening,Reading,Speaking,Writing
2025,January,1,0,,,
,,2,117,,,
,,3,80,,,
,,4,81,,,
,,5,81,,,
,,6,83,,,
,,7,98,,,
,,8,56,,,
,,9,22,,,
,,10,25,,,
,,11,34,,,
,,12,49,,,
,,13,83,,,
,,14,82,,,
,,15,101,,,
,,16,81,,,
,,17,80,,,
,,18,80,,,
,,19,64,,,
,,20,81,,,
,,21,83,,,
,,22,81,,,
,,23,94,,,
,,24,57,,,
,,25,11,,,
,,26,95,,,
,,27,82,,,
,,28,82,,,
,,29,117,,,
,,30,87,,,
,,31,41,,,
2025,February,1,0,,,
,,2,93,,,
,,3,84,,,
,,4,86,,,
,,5,22,,,
,,6,63,,,
,,7,47,,,
,,8,54,,,
,,9,88,,,
,,10,93,,,
,,11,102,,,
,,12,96,,,
,,13,93,,,
,,14,91,,,
,,15,94,,,
,,16,24,,,
,,17,91,,,
,,18,142,,,
,,19,99,,,
,,20,93,,,
,,21,83,,,
,,22,124,,,
,,23,129,,,
,,24,137,,,
,,25,91,,,
,,26,95,,,
,,27,129,,,
,,28,0,,,
2025,March,1,0,,,
,,2,100,,,
,,3,132,,,
,,4,129,,,
,,5,115,,,
,,6,90,,,
,,7,77,,,
,,8,44,,,
,,9,0,,,
,,10,67,,,
,,11,100,,,
,,12,45,,,
,,13,13,,,
,,14,49,,,
,,15,121,,,
,,16,37,,,
,,17,91,,,
,,18,49,,,
,,19,105,,,
,,20,176,,,
,,21,95,,,
,,22,0,,,
,,23,122,,,
,,24,90,,,
,,25,49,,,
,,26,116,,,
,,27,3,,,
,,28,72,,,
,,29,86,,,
,,30,129,,,
,,31,91,,,
,April,1,143,,,
,,2,101,,,
,,3,157,,,
,,4,122,,,
,,5,100,,,
,,6,163,,,
,,7,182,,,
,,8,152,,,
,,9,101,,,
,,10,107,,,
,,11,66,,,
,,12,0,,,
,,13,73,,,
,,14,76,,,
,,15,90,,,
,,16,57,,,
,,17,78,,,
,,18,17,,,
,,19,134,,,
,,20,92,,,
,,21,90,,,
,,22,81,,,
,,23,90,,,
,,24,101,,,
,,25,44,,,
,,26,0,,,
,,27,112,,,
,,28,93,,,
,,29,96,,,
,,30,47,,,
,May,1,98,,,
,,2,90,,,
,,3,91,,,
,,4,93,,,
,,5,115,,,
,,6,92,,,
,,7,130,,,
,,8,62,,,
,,9,45,,,
,,10,0,,,
,,11,94,,,
,,12,124,,,
,,13,90,,,
,,14,136,,,
,,15,90,,,
,,16,105,,,
,,17,5,,,
,,18,100,,,
,,19,151,,,
,,20,160,,,
,,21,94,,,
,,22,146,,,
,,23,101,,,
,,24,120,,,
,,25,180,,,
,,26,183,,,
,,27,169,,,
,,28,163,,,
,,29,160,,,
,,30,166,,,
,,31,178,,,
,June,1,215,,,
,,2,239,,,
,,3,198,,,
,,4,191,,,
,,5,221,,,
,,6,160,,,
,,7,163,,,
,,8,220,,,
,,9,174,,,
,,10,193,,,
,,11,297,,,
,,12,209,,,
,,13,160,,,
,,14,45,,,
,,15,174,,,
,,16,162,,,
,,17,265,,,
,,18,235,,,
,,19,160,,,
,,20,164,,,
,,21,179,,,
,,22,160,,,
,,23,175,,,
,,24,258,,,
,,25,173,,,
,,26,244,,,
,,27,160,,,
,,28,210,,,
,,29,166,,,
,,30,182,,,
,July,1,168,,,
,,2,86,,,
,,3,160,,,
,,4,160,,,
,,5,182,,,
,,6,221,,,
,,7,182,,,
,,8,191,,,
,,9,167,,,
,,10,168,,,
,,11,164,,,
,,12,165,,,
,,13,52,,,
,,14,163,,,
,,15,222,,,
,,16,193,,,
,,17,242,,,
,,18,126,,,
,,19,162,,,
,,20,168,,,
,,21,106,,,
,,22,185,,,
,,23,145,,,
,,24,161,,,
,,25,126,,,
,,26,57,,,
,,27,123,,,
,,28,93,,,
,,29,173,,,
,,30,178,,,
,,31,178,60,,
,August,1,160,10,,
,,2,162,10,,
,,3,162,10,,
,,4,162,,,
,,5,187,13,,
,,6,182,10,,
,,7,208,,,
,,8,162,15,,
,,9,69,,,
,,10,163,10,,
,,11,163,,,
,,12,180,14,,
,,13,172,12,,
,,14,195,,,
,,15,89,15,,
,,16,69,60,,
,,17,61,,,
,,18,180,31,,
,,19,124,44,56,
,,20,162,12,,
,,21,142,21,20,
,,22,145,37,20,
,,23,31,,,
,,24,209,22,,
,,25,175,21,52,
,,26,120,15,50,
,,27,113,,50,
,,28,116,17,53,
,,29,120,39,50,
,,30,161,,,
,,31,163,,,
,September,1,163,74,,
,,2,105,36,55,
,,3,165,8,,
,,4,83,,58,
,,5,118,30,50,
,,6,166,,,
,,7,30,37,,
,,8,182,32,54,
,,9,108,,55,
,,10,160,23,,
,,11,126,49,55,
,,12,170,11,55,
,,13,168,25,,
,,14,56,9,,
,,15,44,,,
,,16,60,,,
,,17,140,8,,
,,18,41,,,
,,19,44,36,,
,,20,58,,,
,,21,19,,,
,,22,116,,,
,,23,124,,,
,,24,120,14,,
,,25,108,30,,
,,26,69,23,,
,,27,18,,,
,,28,200,,,
,,29,65,,,
,,30,185,,54,
,October,1,108,,52,
,,2,52,,,
,,3,92,12,85,
,,4,163,,,
,,5,60,,,
,,6,120,12,54,
,,7,115,,52,
,,8,151,17,52,
,,9,195,20,56,
,,10,123,25,53,
,,11,118,9,,
,,12,162,20,,
,,13,121,49,53,
,,14,176,33,55,
,,15,76,34,57,
,,16,78,37,83,
,,17,115,16,50,
,,18,90,53,,
,,19,168,31,,
,,20,107,27,55,
,,21,115,34,54,
,,22,88,33,81,
,,23,150,28,51,
,,24,109,15,51,
,,25,52,19,,
,,26,91,9,,
,,27,108,22,55,
,,28,118,30,56,
,,29,46,36,50,
,,30,59,,0,
,,31,19,,0,
,November,1,20,,0,
,,2,94,16,0,
,,3,10,,0,
,,4,21,,0,
,,5,156,55,0,
,,6,29,,0,
,,7,93,,28,
,,8,28,,0,
,,9,80,,0,
,,10,73,17,53,
,,11,30,18,53,
,,12,150,29,25,
,,13,35,,54,
,,14,89,,,
,,15,71,,,
,,16,161,,,
,,17,76,29,52,
,,18,104,,52,
,,19,43,26,52,
,,20,42,,52,
,,21,53,,,
,,22,98,,,
,,23,100,,,
,,24,96,,,
,,25,135,,52,
,,26,67,,28,
,,27,49,,52,
,,28,71,,55,
,,29,90,,,
,,30,90,,,
,December,1,38,,56,
,,2,69,29,25,
,,3,40,11,50,
,,4,89,39,55,
,,5,12,39,78,
,,6,51,,55,
,,7,90,23,,
,,8,36,20,55,
,,9,87,,52,
,,10,93,,,
,,11,70,18,51,
,,12,81,61,51,
,,13,127,23,,
,,14,114,32,,
,,15,73,39,55,
,,16,73,50,101,
,,17,61,35,,
,,18,14,,52,
,,19,16,,,
,,20,49,21,,
,,21,52,37,52,
,,22,52,33,53,
,,23,29,22,54,
,,24,23,,,
,,25,23,,,
,,26,129,62,,
,,27,112,11,,
,,28,65,44,55,
,,29,87,71,26,
,,30,23,41,101,
,,31,113,80,,`;

const MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];
const MONTH_SHORT = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

// Chart.js global defaults
Chart.defaults.font.family = "'Inter', system-ui, sans-serif";
Chart.defaults.color = '#70708a';
Chart.defaults.borderColor = 'rgba(255,255,255,0.05)';

Papa.parse(CSV, {
  header: true,
  skipEmptyLines: true,
  complete({ data }) {
    // Forward-fill Year and Month
    let cYear = '', cMonth = '';
    const rows = data.map(r => {
      if (r.Year && r.Year.trim())   cYear  = r.Year.trim();
      if (r.Month && r.Month.trim()) cMonth = r.Month.trim();
      return {
        year:      cYear,
        month:     cMonth,
        day:       parseInt(r.Day)       || 0,
        listening: parseInt(r.Listening) || 0,
        reading:   parseInt(r.Reading)   || 0,
        speaking:  parseInt(r.Speaking)  || 0,
      };
    }).filter(r => r.day > 0);

    // â”€â”€ Totals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const totalL = rows.reduce((s, r) => s + r.listening, 0);
    const totalR = rows.reduce((s, r) => s + r.reading, 0);
    const totalS = rows.reduce((s, r) => s + r.speaking, 0);
    const totalAll = totalL + totalR + totalS;

    const daysTracked = rows.length;
    const daysActive  = rows.filter(r => r.listening > 0 || r.reading > 0 || r.speaking > 0).length;
    const lActiveDays = rows.filter(r => r.listening > 0).length;

    // â”€â”€ Monthly breakdown â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const byMonth = {};
    MONTHS.forEach(m => byMonth[m] = { L: 0, R: 0, S: 0 });
    rows.forEach(r => {
      if (byMonth[r.month]) {
        byMonth[r.month].L += r.listening;
        byMonth[r.month].R += r.reading;
        byMonth[r.month].S += r.speaking;
      }
    });

    const bestMonth = MONTHS.reduce((b, m) => byMonth[m].L > byMonth[b].L ? m : b, MONTHS[0]);

    // â”€â”€ Best day â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const bestDay = rows.reduce((b, r) => r.listening > b.listening ? r : b, rows[0]);

    // â”€â”€ Streaks (listening > 0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let longestStreak = 0, curStreak = 0;
    rows.forEach(r => {
      if (r.listening > 0) { curStreak++; if (curStreak > longestStreak) longestStreak = curStreak; }
      else curStreak = 0;
    });
    let endStreak = 0;
    for (let i = rows.length - 1; i >= 0; i--) {
      if (rows[i].listening > 0) endStreak++; else break;
    }

    const fmtH = m => `${Math.round(m / 60)}h`;
    const fmtHM = m => { const h = Math.floor(m/60), mn = m%60; return mn ? `${h}h ${mn}m` : `${h}h`; };

    // â”€â”€ Stat cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('stat-cards').innerHTML = `
      <div class="card c-orange">
        <div class="card-accent"></div>
        <div class="card-label">Listening</div>
        <div class="card-value">${fmtH(totalL)}</div>
        <div class="card-sub">${totalL.toLocaleString()} min Â· ${lActiveDays} days</div>
      </div>
      <div class="card c-teal">
        <div class="card-accent"></div>
        <div class="card-label">Reading</div>
        <div class="card-value">${fmtH(totalR)}</div>
        <div class="card-sub">${totalR.toLocaleString()} min</div>
      </div>
      <div class="card c-purple">
        <div class="card-accent"></div>
        <div class="card-label">Speaking</div>
        <div class="card-value">${fmtH(totalS)}</div>
        <div class="card-sub">${totalS.toLocaleString()} min</div>
      </div>
      <div class="card c-white">
        <div class="card-accent"></div>
        <div class="card-label">Total Practice</div>
        <div class="card-value">${fmtH(totalAll)}</div>
        <div class="card-sub">${totalAll.toLocaleString()} combined min</div>
      </div>
      <div class="card c-white">
        <div class="card-accent"></div>
        <div class="card-label">Consistency</div>
        <div class="card-value">${daysActive}</div>
        <div class="card-sub">active days of ${daysTracked} tracked</div>
      </div>
    `;

    // â”€â”€ Milestones â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('milestones').innerHTML = `
      <div class="milestone">
        <div class="ms-icon">ğŸ†</div>
        <div>
          <div class="ms-label">Best Single Day</div>
          <div class="ms-value" style="color:var(--orange)">${bestDay.listening} min</div>
          <div class="ms-detail">${bestDay.month} ${bestDay.day}</div>
        </div>
      </div>
      <div class="milestone">
        <div class="ms-icon">ğŸ“…</div>
        <div>
          <div class="ms-label">Best Month</div>
          <div class="ms-value" style="color:var(--orange)">${bestMonth}</div>
          <div class="ms-detail">${byMonth[bestMonth].L.toLocaleString()} listening min</div>
        </div>
      </div>
      <div class="milestone">
        <div class="ms-icon">ğŸ”¥</div>
        <div>
          <div class="ms-label">Longest Streak</div>
          <div class="ms-value" style="color:var(--orange)">${longestStreak} days</div>
          <div class="ms-detail">consecutive listening days</div>
        </div>
      </div>
      <div class="milestone">
        <div class="ms-icon">ğŸ“Š</div>
        <div>
          <div class="ms-label">Avg on Active Days</div>
          <div class="ms-value" style="color:var(--orange)">${Math.round(totalL / lActiveDays)} min</div>
          <div class="ms-detail">listening per active day</div>
        </div>
      </div>
      <div class="milestone">
        <div class="ms-icon">âš¡</div>
        <div>
          <div class="ms-label">Year Avg / Day</div>
          <div class="ms-value" style="color:var(--orange)">${Math.round(totalL / daysTracked)} min</div>
          <div class="ms-detail">listening across all 366 days</div>
        </div>
      </div>
      <div class="milestone">
        <div class="ms-icon">ğŸ¯</div>
        <div>
          <div class="ms-label">Skills Practiced</div>
          <div class="ms-value" style="color:var(--purple)">3 skills</div>
          <div class="ms-detail">Listening Â· Reading Â· Speaking</div>
        </div>
      </div>
    `;

    // â”€â”€ Month-by-month grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('month-grid').innerHTML = MONTHS.map(m => {
      const d = byMonth[m];
      const total = d.L + d.R + d.S;
      return `
        <div class="month-cell">
          <div class="mc-name">${m}</div>
          <div class="mc-row"><span>Listening</span><span style="color:var(--orange)">${d.L.toLocaleString()} min</span></div>
          ${d.R > 0 ? `<div class="mc-row"><span>Reading</span><span style="color:var(--teal)">${d.R.toLocaleString()} min</span></div>` : ''}
          ${d.S > 0 ? `<div class="mc-row"><span>Speaking</span><span style="color:var(--purple)">${d.S.toLocaleString()} min</span></div>` : ''}
          <div class="mc-row" style="margin-top:6px;border-top:1px solid rgba(255,255,255,0.05);padding-top:6px">
            <span>Total</span><span>${fmtHM(total)}</span>
          </div>
        </div>`;
    }).join('');

    // â”€â”€ Charts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    // Monthly grouped bar
    new Chart(document.getElementById('monthlyChart'), {
      type: 'bar',
      data: {
        labels: MONTH_SHORT,
        datasets: [
          { label: 'Listening', data: MONTHS.map(m => byMonth[m].L), backgroundColor: 'rgba(251,146,60,0.85)',  borderRadius: 5, borderSkipped: false },
          { label: 'Reading',   data: MONTHS.map(m => byMonth[m].R), backgroundColor: 'rgba(45,212,191,0.85)', borderRadius: 5, borderSkipped: false },
          { label: 'Speaking',  data: MONTHS.map(m => byMonth[m].S), backgroundColor: 'rgba(192,132,252,0.85)', borderRadius: 5, borderSkipped: false },
        ]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: { label: c => ` ${c.dataset.label}: ${c.raw.toLocaleString()} min (${fmtHM(c.raw)})` }
          }
        },
        scales: {
          x: { grid: { display: false }, ticks: { font: { size: 12 } } },
          y: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { callback: v => v >= 1000 ? (v/1000).toFixed(0)+'k' : v, font: { size: 11 } } }
        }
      }
    });

    // Daily listening (scrollable)
    const dailyLabels = rows.map(r => `${r.month.slice(0,3)} ${r.day}`);
    const BAR_W = 4;
    const dailyWidth = Math.max(1200, rows.length * (BAR_W + 1));
    const dailyCanvas = document.getElementById('dailyChart');
    dailyCanvas.style.width  = dailyWidth + 'px';
    dailyCanvas.style.height = '240px';
    dailyCanvas.width  = dailyWidth * window.devicePixelRatio;
    dailyCanvas.height = 240 * window.devicePixelRatio;

    // Alternate shade per month
    const barColors = rows.map(r => {
      const idx = MONTHS.indexOf(r.month);
      return idx % 2 === 0 ? 'rgba(251,146,60,0.85)' : 'rgba(251,146,60,0.55)';
    });

    new Chart(dailyCanvas, {
      type: 'bar',
      data: {
        labels: dailyLabels,
        datasets: [{ label: 'Listening', data: rows.map(r => r.listening), backgroundColor: barColors, borderRadius: 2, borderSkipped: false }]
      },
      options: {
        responsive: false, animation: false,
        plugins: {
          legend: { display: false },
          tooltip: { callbacks: { label: c => ` ${c.raw} min` } }
        },
        scales: {
          x: { grid: { display: false }, ticks: { maxTicksLimit: 14, maxRotation: 0, font: { size: 11 } } },
          y: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { font: { size: 11 } } }
        }
      }
    });

    // Cumulative listening line
    let cum = 0;
    const cumData = rows.map(r => { cum += r.listening; return parseFloat((cum / 60).toFixed(1)); });

    // Only show month-start labels
    const cumLabels = rows.map((r, i) => r.day === 1 ? r.month.slice(0,3) : '');

    new Chart(document.getElementById('cumulativeChart'), {
      type: 'line',
      data: {
        labels: cumLabels,
        datasets: [{
          label: 'Total hours',
          data: cumData,
          borderColor: '#fb923c',
          backgroundColor: ctx => {
            const g = ctx.chart.ctx.createLinearGradient(0, 0, 0, 260);
            g.addColorStop(0, 'rgba(251,146,60,0.30)');
            g.addColorStop(1, 'rgba(251,146,60,0)');
            return g;
          },
          borderWidth: 2.5,
          pointRadius: 0,
          pointHoverRadius: 4,
          fill: true,
          tension: 0.35,
        }]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            mode: 'index', intersect: false,
            callbacks: {
              title: (items) => {
                const i = items[0].dataIndex;
                return `${rows[i].month} ${rows[i].day}`;
              },
              label: c => ` ${c.raw}h total listening`
            }
          }
        },
        scales: {
          x: {
            grid: { display: false },
            ticks: { maxRotation: 0, font: { size: 12 } }
          },
          y: {
            grid: { color: 'rgba(255,255,255,0.04)' },
            ticks: { callback: v => v + 'h', font: { size: 11 } }
          }
        }
      }
    });
  }
});
</script>
</body>
</html>
